import discord
from discord import app_commands
from discord.ui import Button, View, Modal, TextInput
import asyncio
import os
import logging

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s [%(levelname)s] %(name)s: %(message)s',
    handlers=[
        logging.StreamHandler()
    ]
)

logger = logging.getLogger('ticket_bot')

# –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
TOKEN = os.getenv("TOKEN")

if not TOKEN:
    logger.error("–û–®–ò–ë–ö–ê: –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è!")
    logger.error("–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é TOKEN –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Railway")
    exit(1)

# Define channel IDs
TICKET_CHANNEL_ID = 1359611434862120960  # Channel where ticket button will be displayed
STAFF_CHANNEL_ID = 1362471645922463794   # Channel where completed tickets will be sent
REPORT_CHANNEL_ID = 1362794547012436158  # Channel where report button will be displayed
APPROVED_CHANNEL_ID = 1365696815403630726  # Channel where approved applications will be sent
INFO_CHANNEL_ID = 1361046702404145193  # Channel where info message with buttons will be displayed

# Define role IDs
PLAYER_ROLE_ID = 1376274807284301824  # "–ò–≥—Ä–æ–∫" role ID 

# Define intents
intents = discord.Intents.default()
intents.message_content = True
intents.members = True  # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ç–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ —Å–µ—Ä–≤–µ—Ä–∞

# Create bot client
client = discord.Client(intents=intents)
tree = app_commands.CommandTree(client)

# View —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞
class InfoView(View):
    def __init__(self):
        super().__init__(timeout=None)
    
    @discord.ui.button(label="üåê –°–∞–π—Ç", style=discord.ButtonStyle.link, url="https://site20-production.up.railway.app/")
    async def website_button(self, interaction: discord.Interaction, button: Button):
        # –ö–Ω–æ–ø–∫–∞ —Å URL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ —Å–∞–π—Ç
        pass
    
    @discord.ui.button(label="üéÆ –ö–∞–∫ –∑–∞–π—Ç–∏", style=discord.ButtonStyle.primary, custom_id="how_to_join")
    async def how_to_join_button(self, interaction: discord.Interaction, button: Button):
        # –°–æ–∑–¥–∞–µ–º –∫—Ä–∞—Å–∏–≤—ã–π embed –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
        embed = discord.Embed(
            title="üéÆ –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É",
            description="–°–ª–µ–¥—É–π—Ç–µ —ç—Ç–∏–º –ø—Ä–æ—Å—Ç—ã–º —à–∞–≥–∞–º –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:",
            color=0x00ff00
        )
        embed.add_field(
            name="üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:",
            value="```\n1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Minecraft –≤–µ—Ä—Å–∏–∏ 1.21+\n2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª '–°–µ—Ç–µ–≤–∞—è –∏–≥—Ä–∞'\n3. –ù–∞–∂–º–∏—Ç–µ '–î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä'\n4. –í–≤–µ–¥–∏—Ç–µ IP: minestoryvanilla.imba.land\n5. –ù–∞–∂–º–∏—Ç–µ '–ì–æ—Ç–æ–≤–æ' –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å```",
            inline=False
        )
        embed.add_field(
            name="‚ö° IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞:",
            value="`minestoryvanilla.imba.land`",
            inline=True
        )
        embed.add_field(
            name="üîß –í–µ—Ä—Å–∏—è:",
            value="`1.21+`",
            inline=True
        )
        embed.set_footer(text="–£–¥–∞—á–Ω–æ–π –∏–≥—Ä—ã! üéâ")
        
        await interaction.response.send_message(embed=embed, ephemeral=True)
        logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {interaction.user.name} –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É '–ö–∞–∫ –∑–∞–π—Ç–∏'")
    
    @discord.ui.button(label="üìã –ü—Ä–∞–≤–∏–ª–∞", style=discord.ButtonStyle.secondary, custom_id="rules")
    async def rules_button(self, interaction: discord.Interaction, button: Button):
        # –°–æ–∑–¥–∞–µ–º embed —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Å–µ—Ä–≤–µ—Ä–∞
        embed = discord.Embed(
            title="üìã –ü—Ä–∞–≤–∏–ª–∞ —Å–µ—Ä–≤–µ—Ä–∞ MineStory",
            description="–°–æ–±–ª—é–¥–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤!",
            color=0xffaa00
        )
        embed.add_field(
            name="üö´ –ó–∞–ø—Ä–µ—â–µ–Ω–æ:",
            value="‚Ä¢ –ì—Ä–∏—Ñ–µ—Ä—Å—Ç–≤–æ –∏ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ —á—É–∂–∏—Ö –ø–æ—Å—Ç—Ä–æ–µ–∫\n‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–∏—Ç–æ–≤ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π\n‚Ä¢ –û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è –∏ —Ç–æ–∫—Å–∏—á–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ\n‚Ä¢ –°–ø–∞–º –≤ —á–∞—Ç–µ\n‚Ä¢ –ö—Ä–∞–∂–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —É –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤",
            inline=False
        )
        embed.add_field(
            name="‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ:",
            value="‚Ä¢ –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ\n‚Ä¢ –¢–æ—Ä–≥–æ–≤–ª—è –º–µ–∂–¥—É –∏–≥—Ä–æ–∫–∞–º–∏\n‚Ä¢ –°–æ–≤–º–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã\n‚Ä¢ –ü–æ–º–æ—â—å –Ω–æ–≤–∏—á–∫–∞–º",
            inline=False
        )
        embed.set_footer(text="–ó–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã —Å–∞–Ω–∫—Ü–∏–∏! ‚ö†Ô∏è")
        
        await interaction.response.send_message(embed=embed, ephemeral=True)
        logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {interaction.user.name} –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É '–ü—Ä–∞–≤–∏–ª–∞'")
    
    @discord.ui.button(label="‚ÑπÔ∏è –û —Å–µ—Ä–≤–µ—Ä–µ", style=discord.ButtonStyle.secondary, custom_id="about_server")
    async def about_server_button(self, interaction: discord.Interaction, button: Button):
        # –°–æ–∑–¥–∞–µ–º embed —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–µ—Ä–≤–µ—Ä–µ
        embed = discord.Embed(
            title="‚ÑπÔ∏è –û —Å–µ—Ä–≤–µ—Ä–µ MineStory",
            description="–£–∑–Ω–∞–π—Ç–µ –±–æ–ª—å—à–µ –æ –Ω–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ!",
            color=0x0099ff
        )
        embed.add_field(
            name="üéØ –¢–∏–ø —Å–µ—Ä–≤–µ—Ä–∞:",
            value="–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –≤–∞–Ω–∏–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä",
            inline=True
        )
        embed.add_field(
            name="üë• –°–æ–æ–±—â–µ—Å—Ç–≤–æ:",
            value="–î—Ä—É–∂–µ–ª—é–±–Ω–æ–µ –∏ –∞–∫—Ç–∏–≤–Ω–æ–µ",
            inline=True
        )
        embed.add_field(
            name="üîß –ü–ª–∞–≥–∏–Ω—ã:",
            value="‚Ä¢ ViaVersion - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏–π\n‚Ä¢ PlasmoVoice - –≥–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç",
            inline=False
        )
        embed.add_field(
            name="üéÆ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:",
            value="‚Ä¢ –í–∞–Ω–∏–ª—å–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π\n‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 24/7\n‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è\n‚Ä¢ –ê–∫—Ç–∏–≤–Ω–∞—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è",
            inline=False
        )
        embed.set_footer(text="–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞—à–µ–º—É —Å–æ–æ–±—â–µ—Å—Ç–≤—É! üéâ")
        
        await interaction.response.send_message(embed=embed, ephemeral=True)
        logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {interaction.user.name} –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É '–û —Å–µ—Ä–≤–µ—Ä–µ'")

# Function to send or update info message
async def send_or_update_info_message(channel):
    if not channel:
        logger.error(f"Error: Info channel with ID {INFO_CHANNEL_ID} not found")
        return False
    
    # –°–æ–∑–¥–∞–µ–º –∫—Ä–∞—Å–∏–≤—ã–π embed –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    embed = discord.Embed(
        title="üéÆ MineStory - –í–∞–Ω–∏–ª—å–Ω—ã–π Minecraft –°–µ—Ä–≤–µ—Ä",
        description="–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –Ω–∞—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –≤–∞–Ω–∏–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä! –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è –∏ –Ω–∞—Å–ª–∞–¥–∏—Ç—å—Å—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º Minecraft –æ–ø—ã—Ç–æ–º.",
        color=0x00ff88
    )
    
    embed.add_field(
        name="üåü –û —Å–µ—Ä–≤–µ—Ä–µ:",
        value="MineStory - —ç—Ç–æ —É—é—Ç–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –≤–∞–Ω–∏–ª—å–Ω–æ–≥–æ Minecraft, –≥–¥–µ –∫–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –ø—Ä–æ—è–≤–∏—Ç—å —Å–≤–æ—é –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–∞–π—Ç–∏ –Ω–æ–≤—ã—Ö –¥—Ä—É–∑–µ–π.",
        inline=False
    )
    
    embed.add_field(
        name="üîß –í–µ—Ä—Å–∏—è –∏ –ø–ª–∞–≥–∏–Ω—ã:",
        value="**–í–µ—Ä—Å–∏—è:** `1.21+`\n**–ü–ª–∞–≥–∏–Ω—ã:**\n‚Ä¢ ViaVersion - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏–π\n‚Ä¢ PlasmoVoice - –≥–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç",
        inline=True
    )
    
    embed.add_field(
        name="üéØ IP –∞–¥—Ä–µ—Å:",
        value="`minestoryvanilla.imba.land`",
        inline=True
    )
    
    embed.add_field(
        name="üéÆ –ß—Ç–æ –≤–∞—Å –∂–¥–µ—Ç:",
        value="‚Ä¢ –î—Ä—É–∂–µ–ª—é–±–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ\n‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 24/7\n‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è\n‚Ä¢ –ê–∫—Ç–∏–≤–Ω–∞—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è\n‚Ä¢ –í–∞–Ω–∏–ª—å–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π",
        inline=False
    )
    
    embed.set_footer(text="–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏! üëá")
    embed.set_thumbnail(url="https://cdn.discordapp.com/attachments/1234567890/attachment.png")  # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–∫–æ–Ω–∫—É —Å–µ—Ä–≤–µ—Ä–∞
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏
    has_message = False
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ
        async for message in channel.history(limit=20):
            if message.author.id == client.user.id and len(message.components) > 0:
                # –ï—Å–ª–∏ –Ω–∞—à–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
                has_message = True
                view = InfoView()
                
                # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º embed –∏ –∫–Ω–æ–ø–∫–∞–º–∏
                await message.edit(embed=embed, view=view)
                logger.info(f"–û–±–Ω–æ–≤–ª–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
                return True
        
        # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ
        if not has_message:
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º embed —Å –∫–Ω–æ–ø–∫–∞–º–∏
            view = InfoView()
            await channel.send(embed=embed, view=view)
            logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
            return True
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
        return False

# Button View class –¥–ª—è –∫–Ω–æ–ø–æ–∫ "–ü—Ä–∏–Ω—è—Ç—å" –∏ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å"
class ApplicationActionView(View):
    def __init__(self, applicant_id, applicant_nickname, applicant_age):
        super().__init__(timeout=None)
        self.applicant_id = applicant_id
        self.applicant_nickname = applicant_nickname
        self.applicant_age = applicant_age
    
    @discord.ui.button(label="–ü—Ä–∏–Ω—è—Ç—å", style=discord.ButtonStyle.success, custom_id="accept_application")
    async def accept_application_button(self, interaction: discord.Interaction, button: Button):
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–º–µ–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        is_admin = interaction.user.guild_permissions.administrator
        
        if not is_admin:
            await interaction.response.send_message("–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞—è–≤–∫–∏.", ephemeral=True)
            return
        
        await interaction.response.defer(ephemeral=True)
        
        try:
            # –ü–æ–ª—É—á–∞–µ–º —Å–µ—Ä–≤–µ—Ä –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            guild = interaction.guild
            applicant = await guild.fetch_member(self.applicant_id)
            
            if not applicant:
                await interaction.followup.send(f"–û—à–∏–±–∫–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.", ephemeral=True)
                return
            
            # –í—ã–¥–∞–µ–º —Ä–æ–ª—å "–ò–≥—Ä–æ–∫"
            player_role = guild.get_role(PLAYER_ROLE_ID)
            if player_role:
                await applicant.add_roles(player_role, reason="–ó–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º")
                
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫
                approved_channel = client.get_channel(APPROVED_CHANNEL_ID)
                if approved_channel:
                    approved_embed = discord.Embed(
                        title="–ù–æ–≤—ã–π –∏–≥—Ä–æ–∫ –æ–¥–æ–±—Ä–µ–Ω",
                        color=discord.Color.green()
                    )
                    approved_embed.add_field(name="–ù–∏–∫ –≤ Minecraft", value=self.applicant_nickname, inline=True)
                    approved_embed.add_field(name="–í–æ–∑—Ä–∞—Å—Ç", value=self.applicant_age, inline=True)
                    approved_embed.set_footer(text=f"–ó–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞ {interaction.user.display_name}")
                    
                    await approved_channel.send(content=f"–ó–∞—è–≤–∫–∞ –æ—Ç <@{self.applicant_id}> –ø—Ä–∏–Ω—è—Ç–∞:", embed=approved_embed)
                
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –ª–∏—á–∫—É
                try:
                    server_ip = "minestoryvanilla.imba.land"
                    await applicant.send(f"–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –±—ã–ª–∞ –æ–¥–æ–±—Ä–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!\n\nIP —Å–µ—Ä–≤–µ—Ä–∞: **{server_ip}**\n–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ!")
                except discord.Forbidden:
                    await interaction.followup.send("–ó–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞, –Ω–æ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.", ephemeral=True)
                
                # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∑–∞—è–≤–∫–æ–π
                await interaction.message.edit(content=f"{interaction.message.content}\n\n**–ó–∞—è–≤–∫–∞ –û–î–û–ë–†–ï–ù–ê –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º {interaction.user.mention}**", view=None)
                
                await interaction.followup.send(f"–ó–∞—è–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {applicant.mention} —É—Å–ø–µ—à–Ω–æ –æ–¥–æ–±—Ä–µ–Ω–∞.", ephemeral=True)
            else:
                await interaction.followup.send(f"–û—à–∏–±–∫–∞: –†–æ–ª—å –∏–≥—Ä–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.", ephemeral=True)
        
        except Exception as e:
            await interaction.followup.send(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞—è–≤–∫–∏: {e}", ephemeral=True)
    
    @discord.ui.button(label="–û—Ç–∫–ª–æ–Ω–∏—Ç—å", style=discord.ButtonStyle.danger, custom_id="reject_application")
    async def reject_application_button(self, interaction: discord.Interaction, button: Button):
        await interaction.response.defer(ephemeral=True)
        
        try:
            # –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            guild = interaction.guild
            applicant = await guild.fetch_member(self.applicant_id)
            
            if applicant:
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –ª–∏—á–∫—É
                try:
                    await applicant.send("–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –±—ã–ª–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞. –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É –ø–æ–≤—Ç–æ—Ä–Ω–æ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è.")
                except discord.Forbidden:
                    await interaction.followup.send("–ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞, –Ω–æ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.", ephemeral=True)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∑–∞—è–≤–∫–æ–π
            await interaction.message.edit(content=f"{interaction.message.content}\n\n**–ó–∞—è–≤–∫–∞ –û–¢–ö–õ–û–ù–ï–ù–ê –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º {interaction.user.mention}**", view=None)
            
            await interaction.followup.send("–ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞.", ephemeral=True)
        
        except Exception as e:
            await interaction.followup.send(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏: {e}", ephemeral=True)

# Ticket Modal class
class TicketModal(Modal, title="–ó–∞—è–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä"):
    nickname = TextInput(
        label="–ù–∏–∫",
        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∏–≥—Ä–æ–≤–æ–π –Ω–∏–∫",
        required=True,
    )
    
    age = TextInput(
        label="–í–æ–∑—Ä–∞—Å—Ç",
        placeholder="–£–∫–∞–∂–∏—Ç–µ –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç",
        required=True,
    )
    
    experience = TextInput(
        label="–û–ø—ã—Ç –Ω–∞ –ø–æ–¥–æ–±–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö",
        placeholder="–ò–≥—Ä–∞–ª–∏ –ª–∏ –≤—ã –Ω–∞ –ø–æ–¥–æ–±–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö?",
        required=True,
    )
    
    adequacy = TextInput(
        label="–û—Ü–µ–Ω–∏—Ç–µ —Å–≤–æ—é –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å –æ—Ç 1 –¥–æ 10",
        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 8",
        required=True,
    )
    
    plans = TextInput(
        label="–ß–µ–º –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è",
        placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –ø–ª–∞–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ",
        required=True,
        style=discord.TextStyle.paragraph,
    )
    
    def __init__(self):
        super().__init__(title="–ó–∞—è–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä")
        
    async def on_submit(self, interaction: discord.Interaction):
        # –°–Ω–∞—á–∞–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        await interaction.response.send_message("–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞—è–≤–∫–∏.", ephemeral=True)
        
        # Get the staff channel
        staff_channel = client.get_channel(STAFF_CHANNEL_ID)
        
        # –°–æ–∑–¥–∞–µ–º —ç–º–±–µ–¥ –¥–ª—è –∑–∞—è–≤–∫–∏
        embed = discord.Embed(
            title=f"–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –æ—Ç {self.nickname.value}",
            description="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–æ–∫–µ:",
            color=discord.Color.blue()
        )
        
        embed.add_field(name="–ù–∏–∫", value=self.nickname.value, inline=False)
        embed.add_field(name="–í–æ–∑—Ä–∞—Å—Ç", value=self.age.value, inline=False)
        embed.add_field(name="–ò–≥—Ä–∞–ª –Ω–∞ –ø–æ–¥–æ–±–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö", value=self.experience.value, inline=False)
        embed.add_field(name="–°–∞–º–æ–æ—Ü–µ–Ω–∫–∞ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏", value=self.adequacy.value, inline=False)
        embed.add_field(name="–ü–ª–∞–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ", value=self.plans.value, inline=False)
        
        # Get user for DM
        user = interaction.user
        
        # –§–ª–∞–≥ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –õ–° —ç—Ç–∞–ø–∞
        dm_completed = False
        
        # Send an additional DM to get more information
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å DM
            test_dm = await user.send("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (—ç—Ç–æ –∑–∞–π–º–µ—Ç –Ω–µ –±–æ–ª–µ–µ –º–∏–Ω—É—Ç—ã). –ï—Å–ª–∏ –≤—ã –Ω–µ –æ—Ç–≤–µ—Ç–∏—Ç–µ, –≤–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏.")
            
            # Ask about griefing
            griefing_question = await user.send("–ö–∞–∫ –≤—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –≥—Ä–∏—Ñ—É?")
            try:
                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç –¥–æ 10 –º–∏–Ω—É—Ç –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∫–æ–º—Ñ–æ—Ä—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                griefing_response = await client.wait_for(
                    'message',
                    check=lambda m: m.author == user and isinstance(m.channel, discord.DMChannel),
                    timeout=600.0
                )
                embed.add_field(name="–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –≥—Ä–∏—Ñ—É", value=griefing_response.content, inline=False)
                logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user.name} –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å: {griefing_response.content}")
            except asyncio.TimeoutError:
                embed.add_field(name="–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –≥—Ä–∏—Ñ—É", value="–ù–µ –æ—Ç–≤–µ—Ç–∏–ª –≤ —Ç–µ—á–µ–Ω–∏–µ 10 –º–∏–Ω—É—Ç", inline=False)
                await user.send("–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ. –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É –∏ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã.")
                logger.warning(f"–¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –æ—Ç {user.name}")
                return  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –Ω–µ –≤—ã–¥–∞–µ–º —Ä–æ–ª—å
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å –æ –≥—Ä–∏—Ñ–µ: {e}")
                embed.add_field(name="–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –≥—Ä–∏—Ñ—É", value=f"–û—à–∏–±–∫–∞: {e}", inline=False)
                await user.send("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")
                return
            
            # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –≤–æ–ø—Ä–æ—Å–∞–º–∏
            await asyncio.sleep(1)
            
            # Ask about how they found the server
            await user.send("–û—Ç–∫—É–¥–∞ —É–∑–Ω–∞–ª–∏ –æ —Å–µ—Ä–≤–µ—Ä–µ?")
            try:
                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç –¥–æ 10 –º–∏–Ω—É—Ç
                source_response = await client.wait_for(
                    'message',
                    check=lambda m: m.author == user and isinstance(m.channel, discord.DMChannel),
                    timeout=600.0
                )
                embed.add_field(name="–ò—Å—Ç–æ—á–Ω–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–µ—Ä–µ", value=source_response.content, inline=False)
                logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user.name} –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –≤—Ç–æ—Ä–æ–π –≤–æ–ø—Ä–æ—Å: {source_response.content}")
            except asyncio.TimeoutError:
                embed.add_field(name="–ò—Å—Ç–æ—á–Ω–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–µ—Ä–µ", value="–ù–µ –æ—Ç–≤–µ—Ç–∏–ª –≤ —Ç–µ—á–µ–Ω–∏–µ 10 –º–∏–Ω—É—Ç", inline=False)
                await user.send("–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ. –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É –∏ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã.")
                logger.warning(f"–¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤—Ç–æ—Ä–æ–π –≤–æ–ø—Ä–æ—Å –æ—Ç {user.name}")
                return  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –Ω–µ –≤—ã–¥–∞–µ–º —Ä–æ–ª—å
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å –æ–± –∏—Å—Ç–æ—á–Ω–∏–∫–µ: {e}")
                embed.add_field(name="–ò—Å—Ç–æ—á–Ω–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–µ—Ä–µ", value=f"–û—à–∏–±–∫–∞: {e}", inline=False)
                await user.send("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")
                return
            
            # Thank the user
            try:
                await user.send("–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–∏ –æ—Ç–≤–µ—Ç—ã! –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏.")
                logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user.name}")
                dm_completed = True
                logger.info(f"–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ñ–ª–∞–≥ dm_completed = True –¥–ª—è {user.name}")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –±–ª–∞–≥–æ–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
                # –î–∞–∂–µ –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
                dm_completed = True
                logger.warning(f"–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ñ–ª–∞–≥ dm_completed = True –¥–ª—è {user.name} –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ—à–∏–±–∫—É")
        
        except discord.Forbidden:
            # Cannot send DM to the user
            try:
                await interaction.followup.send("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–∞–º –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–∫—Ä–æ–π—Ç–µ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ Discord –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.", ephemeral=True)
                logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å DM –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user.name} - —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞–∫—Ä—ã—Ç—ã")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–∫—Ä—ã—Ç—ã—Ö DM: {e}")
            return  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –Ω–µ –≤—ã–¥–∞–µ–º —Ä–æ–ª—å
        except Exception as e:
            # Other errors
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ DM: {e}")
            try:
                await interaction.followup.send("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞—è–≤–∫–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.", ephemeral=True)
            except Exception as follow_up_error:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ: {follow_up_error}")
            return  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –Ω–µ –≤—ã–¥–∞–µ–º —Ä–æ–ª—å
            
        # –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –ø—Ä–æ—à–ª–∏ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –õ–°, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞—è–≤–∫—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º
        if dm_completed:
            logger.info(f"–ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏ –¥–ª—è {user.name}")
            success_message = "–í–∞—à–∞ –∑–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏!"
            
            try:
                await interaction.followup.send(success_message, ephemeral=True)
                logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–∞—á–µ –∑–∞—è–≤–∫–∏ –¥–ª—è {user.name}")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–∞—á–µ –∑–∞—è–≤–∫–∏: {e}")
            
            # Add timestamp and user ID
            embed.set_footer(text=f"ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {interaction.user.id} ‚Ä¢ {discord.utils.format_dt(interaction.created_at)}")
            
            # Send the embed to the staff channel with buttons
            if staff_channel:
                try:
                    view = ApplicationActionView(interaction.user.id, self.nickname.value, self.age.value)
                    await staff_channel.send(content=f"<@{interaction.user.id}> –ø–æ–¥–∞–ª –∑–∞—è–≤–∫—É:", embed=embed, view=view)
                    logger.info(f"–ó–∞—è–≤–∫–∞ –¥–ª—è {user.name} —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –∫–∞–Ω–∞–ª –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏")
                except Exception as e:
                    logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏ –≤ –∫–∞–Ω–∞–ª –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏: {e}")
                    try:
                        await user.send("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤–∞—à–µ–π –∑–∞—è–≤–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–∞.")
                    except:
                        pass
            else:
                logger.error(f"Error: Staff channel with ID {STAFF_CHANNEL_ID} not found")
                try:
                    await user.send("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–∞.")
                except:
                    pass
        else:
            logger.warning(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user.name} –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–∫–∏ (dm_completed = False)")
            try:
                await interaction.followup.send("–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–µ –±—ã–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –ª–∏—á–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.", ephemeral=True)
            except:
                pass

# Button View class
class TicketView(View):
    def __init__(self):
        super().__init__(timeout=None)
    
    @discord.ui.button(label="–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É", style=discord.ButtonStyle.primary, custom_id="submit_ticket")
    async def submit_ticket(self, interaction: discord.Interaction, button: Button):
        # Check if user already has the player role
        player_role = interaction.guild.get_role(PLAYER_ROLE_ID)
        if player_role and player_role in interaction.user.roles:
            await interaction.response.send_message("–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Ä–æ–ª—å –∏–≥—Ä–æ–∫–∞! –í—ã –º–æ–∂–µ—Ç–µ –∏–≥—Ä–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.", ephemeral=True)
            return
        
        # Open the ticket modal
        modal = TicketModal()
        await interaction.response.send_modal(modal)

# Report Modal class
class ReportModal(Modal, title="–ñ–∞–ª–æ–±–∞ –Ω–∞ –∏–≥—Ä–æ–∫–∞"):
    reported_player = TextInput(
        label="–ù–∏–∫ –Ω–∞—Ä—É—à–∏—Ç–µ–ª—è",
        placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –∏–≥—Ä–æ–∫–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –∂–∞–ª—É–µ—Ç–µ—Å—å",
        required=True,
    )
    
    violation_type = TextInput(
        label="–¢–∏–ø –Ω–∞—Ä—É—à–µ–Ω–∏—è",
        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –≥—Ä–∏—Ñ, —á–∏—Ç—ã, –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è",
        required=True,
    )
    
    description = TextInput(
        label="–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è",
        placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ",
        required=True,
        style=discord.TextStyle.paragraph,
    )
    
    evidence = TextInput(
        label="–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ (—Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã/–≤–∏–¥–µ–æ)",
        placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)",
        required=False,
        style=discord.TextStyle.paragraph,
    )
    
    def __init__(self):
        super().__init__(title="–ñ–∞–ª–æ–±–∞ –Ω–∞ –∏–≥—Ä–æ–∫–∞")
        
    async def on_submit(self, interaction: discord.Interaction):
        # Get the staff channel
        staff_channel = client.get_channel(STAFF_CHANNEL_ID)
        
        # –°–æ–∑–¥–∞–µ–º —ç–º–±–µ–¥ –¥–ª—è –∂–∞–ª–æ–±—ã
        embed = discord.Embed(
            title=f"–ñ–∞–ª–æ–±–∞ –æ—Ç {interaction.user.display_name}",
            description="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞—Ä—É—à–µ–Ω–∏–∏:",
            color=discord.Color.red()
        )
        
        embed.add_field(name="–ù–∞—Ä—É—à–∏—Ç–µ–ª—å", value=self.reported_player.value, inline=True)
        embed.add_field(name="–¢–∏–ø –Ω–∞—Ä—É—à–µ–Ω–∏—è", value=self.violation_type.value, inline=True)
        embed.add_field(name="–û–ø–∏—Å–∞–Ω–∏–µ", value=self.description.value, inline=False)
        
        if self.evidence.value:
            embed.add_field(name="–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞", value=self.evidence.value, inline=False)
        
        # Add timestamp and user ID
        embed.set_footer(text=f"ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {interaction.user.id} ‚Ä¢ {discord.utils.format_dt(interaction.created_at)}")
        
        # Send the embed to the staff channel
        if staff_channel:
            await staff_channel.send(content=f"<@{interaction.user.id}> –ø–æ–¥–∞–ª –∂–∞–ª–æ–±—É:", embed=embed)
            await interaction.response.send_message("–í–∞—à–∞ –∂–∞–ª–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏!", ephemeral=True)
        else:
            logger.error(f"Error: Staff channel with ID {STAFF_CHANNEL_ID} not found")
            await interaction.response.send_message("–û—à–∏–±–∫–∞: –∫–∞–Ω–∞–ª –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω.", ephemeral=True)

# Report View class
class ReportView(View):
    def __init__(self):
        super().__init__(timeout=None)
    
    @discord.ui.button(label="–ü–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É", style=discord.ButtonStyle.danger, custom_id="submit_report")
    async def submit_report(self, interaction: discord.Interaction, button: Button):
        # Open the report modal
        modal = ReportModal()
        await interaction.response.send_modal(modal)

# Bot events
@client.event
async def on_ready():
    logger.info(f"–ë–æ—Ç {client.user} –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    
    # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—ã
    try:
        synced = await tree.sync()
        logger.info(f"–ö–æ–º–∞–Ω–¥—ã —É—Å–ø–µ—à–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥: {e}")
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –¥–ª—è –∑–∞—è–≤–æ–∫
    ticket_channel = client.get_channel(TICKET_CHANNEL_ID)
    
    if ticket_channel:
        logger.info(f"–ö–∞–Ω–∞–ª –¥–ª—è –∑–∞—è–≤–æ–∫ –Ω–∞–π–¥–µ–Ω: {ticket_channel.name}")
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π
        has_message = False
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ
            async for message in ticket_channel.history(limit=20):
                if message.author.id == client.user.id and len(message.components) > 0:
                    # –ï—Å–ª–∏ –Ω–∞—à–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
                    has_message = True
                    view = TicketView()
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–≤–æ–π –∫–Ω–æ–ø–∫–æ–π
                    await message.edit(content="–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä:", view=view)
                    logger.info(f"–û–±–Ω–æ–≤–ª–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π")
                    break
            
            # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ
            if not has_message:
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π
                view = TicketView()
                await ticket_channel.send("–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä:", view=view)
                logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π")
        
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–æ–π: {e}")
    else:
        logger.error(f"Error: Ticket channel with ID {TICKET_CHANNEL_ID} not found")
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –¥–ª—è –∂–∞–ª–æ–±
    report_channel = client.get_channel(REPORT_CHANNEL_ID)
    
    if report_channel:
        logger.info(f"–ö–∞–Ω–∞–ª –¥–ª—è –∂–∞–ª–æ–± –Ω–∞–π–¥–µ–Ω: {report_channel.name}")
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π
        has_message = False
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ
            async for message in report_channel.history(limit=20):
                if message.author.id == client.user.id and len(message.components) > 0:
                    # –ï—Å–ª–∏ –Ω–∞—à–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
                    has_message = True
                    view = ReportView()
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–≤–æ–π –∫–Ω–æ–ø–∫–æ–π
                    await message.edit(content="–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É –Ω–∞ –∏–≥—Ä–æ–∫–∞:", view=view)
                    logger.info(f"–û–±–Ω–æ–≤–ª–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –∂–∞–ª–æ–±")
                    break
            
            # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ
            if not has_message:
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π
                view = ReportView()
                await report_channel.send("–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É –Ω–∞ –∏–≥—Ä–æ–∫–∞:", view=view)
                logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –∂–∞–ª–æ–±")
        
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –∂–∞–ª–æ–±: {e}")
    else:
        logger.error(f"Error: Report channel with ID {REPORT_CHANNEL_ID} not found")
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞
    info_channel = client.get_channel(INFO_CHANNEL_ID)
    
    if info_channel:
        logger.info(f"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –Ω–∞–π–¥–µ–Ω: {info_channel.name}")
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        success = await send_or_update_info_message(info_channel)
        if success:
            logger.info("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ/–æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞")
        else:
            logger.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞")
    else:
        logger.error(f"Error: Info channel with ID {INFO_CHANNEL_ID} not found")

# –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
@client.event
async def on_connect():
    logger.info("–ë–æ—Ç –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ Discord")

@client.event
async def on_disconnect():
    logger.warning("–ë–æ—Ç –æ—Ç–∫–ª—é—á–∏–ª—Å—è –æ—Ç Discord. –û–∂–∏–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...")

@client.event
async def on_resumed():
    logger.info("–°–µ—Å—Å–∏—è —É—Å–ø–µ—à–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞")

@client.event
async def on_error(event, *args, **kwargs):
    logger.error(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ —Å–æ–±—ã—Ç–∏–∏ {event}: {args}, {kwargs}")
    import traceback
    traceback.print_exc()

@client.event 
async def on_application_command_error(interaction, error):
    logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã: {error}")
    import traceback
    traceback.print_exc()
    try:
        await interaction.response.send_message(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {error}", ephemeral=True)
    except discord.errors.InteractionResponded:
        await interaction.followup.send(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {error}", ephemeral=True)
    except Exception as e:
        logger.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ: {e}")

# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏
@tree.command(name="send_info", description="–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏")
@app_commands.default_permissions(administrator=True)
async def send_info(interaction: discord.Interaction):
    # Get the info channel
    info_channel = client.get_channel(INFO_CHANNEL_ID)
    
    if info_channel:
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        success = await send_or_update_info_message(info_channel)
        
        if success:
            await interaction.response.send_message("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ/–æ–±–Ω–æ–≤–ª–µ–Ω–æ!", ephemeral=True)
        else:
            await interaction.response.send_message("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.", ephemeral=True)
    else:
        await interaction.response.send_message(f"–û—à–∏–±–∫–∞: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª —Å ID {INFO_CHANNEL_ID} –Ω–µ –Ω–∞–π–¥–µ–Ω.", ephemeral=True)

# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–æ–π –∑–∞—è–≤–∫–∏
@tree.command(name="send_ticket", description="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–∫–∏")
@app_commands.default_permissions(administrator=True)
async def send_ticket(interaction: discord.Interaction):
    view = TicketView()
    await interaction.response.send_message("–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä:", view=view)

# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–æ–π –∂–∞–ª–æ–±—ã
@tree.command(name="send_report", description="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –ø–æ–¥–∞—á–∏ –∂–∞–ª–æ–±—ã")
@app_commands.default_permissions(administrator=True)
async def send_report(interaction: discord.Interaction):
    view = ReportView()
    await interaction.response.send_message("–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É –Ω–∞ –∏–≥—Ä–æ–∫–∞:", view=view)

# Run the bot
try:
    client.run(TOKEN, reconnect=True, log_handler=None)
except discord.errors.LoginFailure:
    logger.critical("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞.")
except Exception as e:
    logger.critical(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞: {e}")
    import traceback
    traceback.print_exc()
